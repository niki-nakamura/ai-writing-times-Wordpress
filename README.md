以下は、記事生成から自動投稿までの全体の流れを、具体的な設定内容とともに分かりやすく解説したものです。これに沿って作業を進めることで、GoogleスプレッドシートとGAS（Google Apps Script）、ChatGPT API、そしてWordPressを連携させ、キーワード入力だけでSEOを意識した10,000文字以上の記事を大量に生成し、ワンクリックで自動投稿できる仕組みを構築できます。

---

## 1. 必要なもの

- **ChatGPTのAPIキー**  
  ※OpenAIのAPIキー（例：sk-…）を取得しておく必要があります。

- **Googleスプレッドシート**  
  提供されているサンプルシート（例：[こちらのリンク](https://docs.google.com/spreadsheets/d/17w3_rqfX3YyAmVS4yhhaVl6_YIjxiJGn-q1ZWHfIiSs/edit?usp=sharing)）を自分用にコピーします。

- **Google Apps Script（GAS）コード**  
  2種類のスクリプトが必要です。  
  1. **writegpt**：ChatGPT APIを呼び出し、記事本文を生成するためのコード  
  2. **wordpress**：生成した記事をWordPressに自動投稿するためのコード（記事内では一部のみ公開されており、詳細は別途提供される場合もあります）

- **WordPressのログイン情報**  
  サイトURL、ユーザー名、パスワードなど、WordPressへの接続に必要な情報

---

## 2. Googleスプレッドシートの設定

### A. シートのコピー方法

1. 上記リンクのスプレッドシートを開く  
2. メニュー「**ファイル**」→「**コピーを作成**」を選択  
3. 表示されたポップアップのまま「**コピーを作成**」をクリックすると、自分のドライブにコピーが保存されます

### B. シートの構成と役割

スプレッドシートには大きく以下の3つのシートが用意されています。

#### 【シート「1」：記事生成用シート】

- **A列：キーワード入力**  
  - 記事にしたいテーマや単語を入力します。  
  - **注意点**：A4以降のセルのうち、背景色が付いている奇数行にのみ入力してください。偶数行は入力しないようにしましょう。
  
- **B列：タイトル**  
  - 生成された記事タイトルが自動的に出力されます。

- **C列：見出し**  
  - SEOを意識した見出しが自動生成されます。

- **E～N列：記事本文**  
  - 各見出しに沿って文章が生成され、ここに分割して配置されます。

- **O列：投稿用記事**  
  - 複数のパーツをまとめた最終的な記事内容がここに表示されます。

- **P列：投稿済み管理**  
  - 投稿済みかどうかを管理し、重複投稿を防ぎます。

- **Q列以降**  
  - GAS用の設定や各種関数が組み込まれているため、絶対に変更しないようにしてください。

#### 【シート「2」：プロンプト設定シート】

- **基本プロンプト**  
  - セルC3に、記事生成のベースとなるプロンプトが記載されています。  
  - ここには、見出しの作成や各見出しに対応した文章生成の指示が含まれており、記事のクオリティに大きく影響します。
  
- **カスタムプロンプト**  
  - 自由に変更できる部分ですが、基本プロンプト自体は変更しないことが推奨されています。

#### 【シート「1.1」：参照用シート】

- 生成された記事のタイトルと本文の一覧が表示されます。
- **D列**に記事の文字数が自動出力され、記事の網羅性やボリュームを確認できます。
- A列のフィルター機能を使い、空白セルを除外して一覧を確認してください。

---

## 3. 記事作成のGAS設定（writegpt）

このスクリプトは、Googleスプレッドシート内の入力情報とプロンプトをもとに、ChatGPT API（gpt-3.5-turbo）を呼び出して記事を生成する役割を担います。

### A. GASエディタの起動

1. スプレッドシート上部のメニュー「**拡張機能**」→「**Apps Script**」をクリックして、スクリプトエディタを開きます。

### B. コードの貼り付けと設定

以下のコードをすべて削除されたエディタに貼り付けます：

```javascript
function writeGPT(additionalPrompt, originalSentence) {
  // OpenAIのAPIキー。セキュリティのため、本番環境では安全な場所に保管することを推奨します。
  const API_KEY = "sk-XXX";  // ここにあなたのOpenAI APIキーを入力してください
  
  // 対象のスプレッドシートを取得
  const sheet1 = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("1");
  const sheet2 = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("2");

  // シート「2」のC3セルから基本となるプロンプトを取得
  const basePrompt = sheet2.getRange("C3").getValue();

  // 入力された文章をプロンプトに組み込み
  const prompt = basePrompt.replace("{content}", additionalPrompt + originalSentence);
  
  // GPT-3.5-turboに送信するメッセージの作成
  const messages = [{ role: "user", content: prompt }];
  const payload = {
    model: "gpt-3.5-turbo",
    messages: messages,
  };

  // APIリクエストのオプション設定
  const options = {
    method: "post",
    contentType: "application/json",
    headers: { Authorization: "Bearer " + API_KEY },
    payload: JSON.stringify(payload),
    muteHttpExceptions: true
  };

  // OpenAIのAPIエンドポイント
  const url = "https://api.openai.com/v1/chat/completions";

  // APIにリクエストを送信し、レスポンスを取得
  const response = UrlFetchApp.fetch(url, options);
  const responseData = JSON.parse(response.getContentText());
  
  if (responseData.choices && responseData.choices.length > 0) {
    const rewritedSentence = responseData.choices[0].message.content.trim();
    return rewritedSentence;
  } else {
    // choicesが存在しないか、空の場合はエラーメッセージを返す
    return "エラー: APIからの適切なレスポンスが得られませんでした。";
  }
}
```

- **必ず**「sk-XXX」の部分をあなたの正しいAPIキーに変更してください。
- ファイル名を「**writegpt**」に変更し、保存します。

### C. 初回実行と権限の許可

- コードを保存後、実行ボタンをクリックします。  
- 初回実行時は、スクリプトが外部サービス（OpenAI APIなど）にアクセスするための権限許可のポップアップが表示されますので、指示に従い許可してください。

---

## 4. 記事投稿のGAS設定（WordPress連携）

### A. WordPress自動投稿用のスクリプト

- **新規GASファイル作成**  
  スクリプトエディタ上で新しいファイルを作成し、ファイル名を「**wordpress**」とします。

- **コードの貼り付け**  
  記事投稿用のコードを貼り付けます。  
  ※記事内では「この続きを見るには購入する必要があります」と記載されているため、完全なコードは提供されていない場合もありますが、基本的な流れは以下の通りです：
  - WordPressのAPIエンドポイント（またはXML-RPC URL）に接続するコード
  - スプレッドシートの「投稿用記事」列（O列）の内容を取得
  - 必要な認証情報（WordPressのユーザー名、パスワード、サイトURLなど）を設定
  - 取得した記事内容をWordPressにPOSTリクエストとして送信し、自動で投稿する

- **設定の注意点**  
  WordPress側のAPI設定や認証方式（Basic認証やアプリケーションパスワードなど）に合わせて、コード内の設定を正しく記入してください。  
  詳細な手順については、記事内に記載されたリンク（例：https://tonari-it.com/gas-script-approval/）や、WordPressの公式ドキュメントを参考にしてください。

---

## 5. 全体の流れと実際の動作

1. **キーワード入力**  
   - シート「1」のA列に、記事にしたいキーワードやテーマを（奇数行に）入力します。

2. **記事生成の実行**  
   - GASのwritegpt関数が、シート「2」にある基本プロンプトと入力キーワードをもとに、ChatGPT APIへリクエストを送信。  
   - その結果、B列（タイトル）、C列（見出し）、E～N列（各見出しに対応する本文）が自動で生成されます。

3. **生成記事の確認**  
   - シート「1.1」では、生成された記事のタイトルや本文、文字数が一覧化されます。  
   - 必要に応じて、ここで記事の内容を確認・修正することができます。

4. **自動投稿の実行**  
   - WordPress連携用のGAS（wordpress）が起動すると、シート「1」の投稿用記事（O列）の内容がWordPressに自動で投稿されます。  
   - 投稿済みの記事は、P列で管理され、重複投稿が防止されます。

---

## 6. 注意点とトラブルシューティング

- **セルの入力ルール**  
  - A列は、色付きの奇数行にのみ入力してください。偶数行に入力すると、記事生成処理に影響を及ぼす恐れがあります。

- **プロンプトの変更**  
  - シート「2」の基本プロンプトは、記事の品質に直結するため、原則変更せず、必要な場合のみカスタムプロンプト部分を調整してください。

- **APIキーとセキュリティ**  
  - APIキーは、第三者に知られないよう厳重に管理してください。また、コードを実行する際は、各種権限許可のリクエストに正しく応じることが必要です。

- **WordPress連携の設定**  
  - WordPress側のAPI設定や認証情報の誤りは、記事の投稿が失敗する原因となります。設定内容を再確認し、必要な場合は公式ドキュメントも参考にしてください。

---

## 7. まとめ

このシステムを導入することで、以下のような効果が期待できます：

- **従来の作業時間の大幅短縮**  
  - 以前は1記事あたり1時間以上かかっていた作業を、数分で100記事程度生成・投稿可能に。

- **SEOを意識した記事生成**  
  - 基本プロンプトにより、見出しと本文の網羅性を確保し、SEOに効果的な記事が生成される。

- **自動投稿による効率化**  
  - WordPressへの自動投稿機能により、コピペなどの手動作業を完全に排除。

以上の手順と設定内容に沿って、Googleスプレッドシート、GAS、ChatGPT API、そしてWordPressを連携させることで、効率的かつ大量のブログ記事生成と自動投稿が実現できます。各ステップで設定や入力ミスがないか注意しながら進めれば、運用作業の大幅な削減とブログの生産性向上が期待できるでしょう。

もし途中で不明な点やエラーが発生した場合は、元記事内のリンク先の解説ページや、関連するオンラインドキュメントを参考にして対応してください。
